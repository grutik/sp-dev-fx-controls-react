{"version":3,"sources":["controls/filePicker/StockImagesTab/StockImages.tsx"],"names":[],"mappings":"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","file":"controls/filePicker/StockImagesTab/StockImages.js","sourcesContent":["import * as React from 'react';\r\nimport styles from './StockImages.module.scss';\r\nimport { StockImagesEvent, SubmitValue, IStockImagesProps } from '.';\r\nimport { GeneralHelper } from '../../../Utilities';\r\nimport { IFilePickerResult } from '..';\r\n\r\nexport class StockImages extends React.Component<IStockImagesProps> {\r\n  public componentDidMount() {\r\n    window.addEventListener(\"message\", this._handleImageIframeEvent);\r\n  }\r\n\r\n  public componentWillUnmount() {\r\n    window.removeEventListener(\"message\", this._handleImageIframeEvent);\r\n  }\r\n\r\n  public render(): React.ReactElement<IStockImagesProps> {\r\n    const { language } = this.props;\r\n\r\n    const themesColor = `&themecolors=${encodeURIComponent(this.getCurrentThemeConfiguration())}`;\r\n    const contentPickerUrl = `https://hubblecontent.osi.office.net/contentsvc/external/m365contentpicker/index.html?p=3&app=1001&aud=prod&channel=devmain&setlang=${language}&msel=0&env=prod&premium=1${themesColor}`;\r\n\r\n    return (\r\n      <div className={styles.tabContainer}>\r\n        <div className={styles.tab}>\r\n          <div className={styles.stockImagesPickerContainer}>\r\n            <iframe className={styles.stockImagesPicker} role={\"application\"} id={\"stockImagesIFrame\"}\r\n            src={contentPickerUrl} />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private _handleImageIframeEvent = (event) => {\r\n    if (!event || !event.origin || event.origin.indexOf(\"https://hubblecontent.osi.office.net\") !== 0) {\r\n      return;\r\n    }\r\n\r\n    const eventData: StockImagesEvent = JSON.parse(event.data);\r\n\r\n    if (eventData.MessageId === \"AddItem\") {\r\n      this._handleSave(eventData);\r\n    } else if (eventData.MessageId === \"CancelDialog\") {\r\n      this._handleClose();\r\n    } \r\n  }\r\n\r\n  /**\r\n   * Called when user saves\r\n   */\r\n  private _handleSave = (event: StockImagesEvent) => {\r\n    let filePickerResult: IFilePickerResult = null;\r\n    const cdnFileInfo: SubmitValue = event.Values && (event.Values as SubmitValue[]).length > 0 ? (event.Values as SubmitValue[])[0] : null;\r\n    if (cdnFileInfo) {\r\n      filePickerResult = {\r\n        downloadFileContent: () => { return this.props.fileSearchService.downloadBingContent(cdnFileInfo.sourceUrl, GeneralHelper.getFileNameFromUrl(GeneralHelper.getFileNameFromUrl(cdnFileInfo.sourceUrl))); },\r\n        fileAbsoluteUrl: cdnFileInfo.sourceUrl,\r\n        fileName: GeneralHelper.getFileNameFromUrl(cdnFileInfo.sourceUrl),\r\n        fileNameWithoutExtension: GeneralHelper.getFileNameWithoutExtension(cdnFileInfo.sourceUrl)\r\n      };\r\n    }\r\n    \r\n    this.props.onSave(filePickerResult);\r\n  }\r\n\r\n  /**\r\n   * Called when user closes tab\r\n   */\r\n  private _handleClose = () => {\r\n    this.props.onClose();\r\n  }\r\n\r\n  private getCurrentThemeConfiguration() {\r\n    if (!window[\"__themeState__\"] || !window[\"__themeState__\"].theme) {\r\n      return \"\";\r\n    }\r\n\r\n    const primaryColor = window[\"__themeState__\"].theme[\"themePrimary\"];\r\n    const textColor = window[\"__themeState__\"].theme[\"primaryText\"];\r\n    const primaryBackground = window[\"__themeState__\"].theme[\"bodyBackground\"]; \r\n    const neutralLighter = window[\"__themeState__\"].theme[\"neutralLighter\"]; \r\n\r\n    const theme = `{\"primaryColor\":\"${primaryColor}\",\"textColor\":\"${textColor}\",\"backgroundColor\":\"${primaryBackground}\",\"neutralLighterColor\":\"${neutralLighter}\"}`;\r\n    return theme;\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\..\\src"}