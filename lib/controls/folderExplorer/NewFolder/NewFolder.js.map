{"version":3,"sources":["controls/folderExplorer/NewFolder/NewFolder.tsx"],"names":[],"mappings":"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","file":"controls/folderExplorer/NewFolder/NewFolder.js","sourcesContent":["import * as React from 'react';\r\nimport { Icon, IIconProps } from 'office-ui-fabric-react/lib/Icon';\r\nimport { IconButton } from 'office-ui-fabric-react/lib/Button';\r\nimport { TextField } from 'office-ui-fabric-react/lib/TextField';\r\nimport { Spinner, SpinnerSize } from \"office-ui-fabric-react/lib/Spinner\";\r\nimport styles from './NewFolder.module.scss';\r\nimport * as strings from 'ControlStrings';\r\nimport { INewFolderProps, INewFolderState } from '.';\r\nimport { FolderExplorerService } from '../../../services/FolderExplorerService';\r\nimport { IFolder, IFolderExplorerService } from '../../../services/IFolderExplorerService';\r\n\r\nconst addIcon: IIconProps = { iconName: 'CheckMark' };\r\n\r\nexport class NewFolder extends React.Component<INewFolderProps, INewFolderState> {\r\n\r\n  private _spService: IFolderExplorerService;\r\n\r\n  constructor(props: INewFolderProps) {\r\n    super(props);\r\n\r\n    this._spService = new FolderExplorerService(this.props.context.serviceScope);\r\n\r\n    this.state = {\r\n      folderName: '',\r\n      showInput: false,\r\n      loading: false,\r\n    };\r\n  }\r\n\r\n\r\n  public render(): React.ReactElement<INewFolderProps> {\r\n    return (\r\n      <div className={styles.libraryItem}>\r\n        {this.state.loading &&\r\n          <span className={styles.spinner}><Spinner size={SpinnerSize.xSmall} /></span>\r\n        }\r\n        {!this.state.loading &&\r\n          <Icon iconName=\"FabricNewFolder\" className={styles.folderIcon}></Icon>\r\n        }\r\n        {!this.state.showInput &&\r\n          <div className={styles.defaultText} onClick={this._onShowInputChange}>New folder</div>\r\n        }\r\n        {this.state.showInput &&\r\n          <TextField\r\n            placeholder={strings.NewFolderNamePlaceholder}\r\n            value={this.state.folderName}\r\n            onChanged={this._onFolderNameChange}\r\n          // styles={{ fieldGroup: { width: 300 } }}\r\n          />\r\n        }\r\n        {this.state.folderName.length > 0 &&\r\n          <IconButton\r\n            iconProps={addIcon}\r\n            title=\"Add\"\r\n            ariaLabel=\"Add\"\r\n            className={styles.button}\r\n            disabled={this.state.loading}\r\n            onClick={this._addSubFolder} />\r\n        }\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private _onFolderNameChange = (newValue?: string) => {\r\n    this.setState({ folderName: newValue || '' });\r\n  }\r\n\r\n  private _onShowInputChange = (event: React.MouseEvent<HTMLDivElement>) => {\r\n    this.setState({ showInput: true });\r\n  }\r\n\r\n  /**\r\n * Add new subfolder to current folder\r\n */\r\n  private _addSubFolder = async (): Promise<void> => {\r\n\r\n    let newFolder: IFolder = null;\r\n\r\n    this.setState({ loading: true });\r\n\r\n    try {\r\n      const siteAbsoluteUrl = this.props.siteAbsoluteUrl || this.props.context.pageContext.web.absoluteUrl;\r\n\r\n      const folder = await this._spService.AddFolder(\r\n        siteAbsoluteUrl,\r\n        this.props.selectedFolder.ServerRelativeUrl,\r\n        this.state.folderName);\r\n\r\n      // update folder variable to be used on the callback\r\n      newFolder = { Name: folder.Name, ServerRelativeUrl: folder.ServerRelativeUrl };\r\n      // update return variable\r\n\r\n      this.setState({ loading: false, folderName: '' });\r\n\r\n    } catch (error) {\r\n      console.error('Error adding folder', error);\r\n    }\r\n\r\n    // callback\r\n    this.props.addSubFolder(newFolder);\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\..\\src"}