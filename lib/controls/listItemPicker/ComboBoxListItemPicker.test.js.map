{"version":3,"sources":["controls/listItemPicker/ComboBoxListItemPicker.test.tsx"],"names":[],"mappings":"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","file":"controls/listItemPicker/ComboBoxListItemPicker.test.js","sourcesContent":["/// <reference types=\"sinon\" />\r\n\r\nimport * as React from 'react';\r\nimport { assert, expect } from 'chai';\r\nimport { mount, ReactWrapper } from 'enzyme';\r\nimport { ComboBoxListItemPicker } from './ComboBoxListItemPicker';\r\nimport { RequestClientMock } from '../../common/mocks/RequestClientMock';\r\n\r\ndeclare const sinon;\r\n\r\nlet mockHttpClient: RequestClientMock = new RequestClientMock(null);\r\nmockHttpClient.Requests.push({\r\n  url: \"/sites/test-site/_api/web/lists('TestId')/items?$select=Id,Title&$filter=Id gt 0\",\r\n  method: \"GET\",\r\n  resultString: JSON.stringify({ \"odata.metadata\": \"\", \"value\": [{ \"odata.type\": \"SP.Data.Test_x0020_listListItem\", \"odata.id\": \"9624204a-c049-49a1-8a18-a417872f8883\", \"odata.etag\": \"\\\"2\\\"\", \"odata.editLink\": \"Web/Lists(guid'490fae3c-f8cb-4b50-9737-f2c94f6b6727')/Items(1)\", \"Id\": 1, \"ID\": 1, \"Title\": \"Test 1\" }, { \"odata.type\": \"SP.Data.Test_x0020_listListItem\", \"odata.id\": \"8b0e4ce8-f1e4-4b17-8f95-1ea7d63fefd6\", \"odata.etag\": \"\\\"1\\\"\", \"odata.editLink\": \"Web/Lists(guid'490fae3c-f8cb-4b50-9737-f2c94f6b6727')/Items(2)\", \"Id\": 2, \"ID\": 2, \"Title\": \"Test 2\" }, { \"odata.type\": \"SP.Data.Test_x0020_listListItem\", \"odata.id\": \"62aea125-e442-44cf-ab08-c555ffdd2798\", \"odata.etag\": \"\\\"1\\\"\", \"odata.editLink\": \"Web/Lists(guid'490fae3c-f8cb-4b50-9737-f2c94f6b6727')/Items(3)\", \"Id\": 3, \"ID\": 3, \"Title\": \"Test 3\" }, { \"odata.type\": \"SP.Data.Test_x0020_listListItem\", \"odata.id\": \"a25c55b2-9a4f-4976-8a12-f77393abe437\", \"odata.etag\": \"\\\"1\\\"\", \"odata.editLink\": \"Web/Lists(guid'490fae3c-f8cb-4b50-9737-f2c94f6b6727')/Items(4)\", \"Id\": 4, \"ID\": 4, \"Title\": \"Test 4\" }, { \"odata.type\": \"SP.Data.Test_x0020_listListItem\", \"odata.id\": \"8c57be67-a9a8-46c8-8954-6e51d3464be2\", \"odata.etag\": \"\\\"1\\\"\", \"odata.editLink\": \"Web/Lists(guid'490fae3c-f8cb-4b50-9737-f2c94f6b6727')/Items(5)\", \"Id\": 5, \"ID\": 5, \"Title\": \"Test 5\" }, { \"odata.type\": \"SP.Data.Test_x0020_listListItem\", \"odata.id\": \"d130664b-4e28-4ae5-b567-a3189f887922\", \"odata.etag\": \"\\\"1\\\"\", \"odata.editLink\": \"Web/Lists(guid'490fae3c-f8cb-4b50-9737-f2c94f6b6727')/Items(6)\", \"Id\": 6, \"ID\": 6, \"Title\": \"Test 6\" }, { \"odata.type\": \"SP.Data.Test_x0020_listListItem\", \"odata.id\": \"6e333b93-3f19-40ee-943c-19817193a3de\", \"odata.etag\": \"\\\"1\\\"\", \"odata.editLink\": \"Web/Lists(guid'490fae3c-f8cb-4b50-9737-f2c94f6b6727')/Items(7)\", \"Id\": 7, \"ID\": 7, \"Title\": \"Test 7\" }, { \"odata.type\": \"SP.Data.Test_x0020_listListItem\", \"odata.id\": \"a0063d1f-66ab-461b-8032-7dd38d7b8749\", \"odata.etag\": \"\\\"1\\\"\", \"odata.editLink\": \"Web/Lists(guid'490fae3c-f8cb-4b50-9737-f2c94f6b6727')/Items(8)\", \"Id\": 8, \"ID\": 8, \"Title\": \"Test 8\" }, { \"odata.type\": \"SP.Data.Test_x0020_listListItem\", \"odata.id\": \"8aca4c7c-4922-45e9-9f03-7d4a4bb6f926\", \"odata.etag\": \"\\\"1\\\"\", \"odata.editLink\": \"Web/Lists(guid'490fae3c-f8cb-4b50-9737-f2c94f6b6727')/Items(9)\", \"Id\": 9, \"ID\": 9, \"Title\": \"Test 9\" }, { \"odata.type\": \"SP.Data.Test_x0020_listListItem\", \"odata.id\": \"f352a0c8-711b-47e4-9990-2a7121f961c3\", \"odata.etag\": \"\\\"1\\\"\", \"odata.editLink\": \"Web/Lists(guid'490fae3c-f8cb-4b50-9737-f2c94f6b6727')/Items(10)\", \"Id\": 10, \"ID\": 10, \"Title\": \"Test 10\" }] })\r\n});\r\ndescribe('<ComboBoxListItemPicker />', () => {\r\n  it(\"Should render initial data\", () => {\r\n    return new Promise((resolve, error) => {\r\n      let comboBox = mount(<ComboBoxListItemPicker\r\n        columnInternalName=\"Title\"\r\n        spHttpClient={mockHttpClient}\r\n        webUrl=\"/sites/test-site\"\r\n        filter=\"Id gt 0\"\r\n        listId=\"TestId\"\r\n        onInitialized={() => {\r\n\r\n          expect(comboBox.state('availableOptions')).to.have.length(10);\r\n          resolve();\r\n        }}\r\n        onSelectedItem={(item) => { }} />);\r\n    });\r\n  });\r\n  it(\"Should call onSelectedItem\", () => {\r\n    return new Promise((resolve, error) => {\r\n      let comboBox = mount(<ComboBoxListItemPicker\r\n        columnInternalName=\"Title\"\r\n        spHttpClient={mockHttpClient}\r\n        webUrl=\"/sites/test-site\"\r\n        filter=\"Id gt 0\"\r\n        listId=\"TestId\"\r\n        onInitialized={() => {\r\n\r\n          let ddBtn = comboBox.find('.ms-Button-flexContainer').first();\r\n          ddBtn.simulate('click');\r\n          //actual list is not part of the component\r\n          let checkBoxBtn = document.querySelectorAll('.ms-ComboBox-option')[3];\r\n          (checkBoxBtn as HTMLButtonElement).click();\r\n\r\n          //ddBtn.simulate('click');\r\n        }}\r\n        onSelectedItem={(item) => {\r\n          expect(item.Id).to.equal(4);\r\n\r\n          resolve();\r\n        }} />);\r\n    });\r\n  });\r\n  it(\"Should initialize with default selection (id)\", () => {\r\n    return new Promise((resolve, error) => {\r\n      let comboBox = mount(<ComboBoxListItemPicker\r\n        columnInternalName=\"Title\"\r\n        spHttpClient={mockHttpClient}\r\n        webUrl=\"/sites/test-site\"\r\n        defaultSelectedItems={[1]}\r\n        filter=\"Id gt 0\"\r\n        listId=\"TestId\"\r\n        onInitialized={() => {\r\n          let ddInput = comboBox.find('.ms-ComboBox-Input').first();\r\n          expect((ddInput.getNode() as any).value).to.be.equal(\"Test 1\");\r\n\r\n          resolve();\r\n        }}\r\n        onSelectedItem={(item) => {\r\n        }} />);\r\n    });\r\n  });\r\n  it(\"Should initialize with default selection (object)\", () => {\r\n    return new Promise((resolve, error) => {\r\n      let comboBox = mount(<ComboBoxListItemPicker\r\n        columnInternalName=\"Title\"\r\n        spHttpClient={mockHttpClient}\r\n        webUrl=\"/sites/test-site\"\r\n        defaultSelectedItems={[{Id:1, Title: \"Test 1\"}]}\r\n        filter=\"Id gt 0\"\r\n        listId=\"TestId\"\r\n        onInitialized={() => {\r\n\r\n          let ddInput = comboBox.find('.ms-ComboBox-Input').first();\r\n          expect((ddInput.getNode() as any).value).to.be.equal(\"Test 1\");\r\n\r\n          resolve();\r\n        }}\r\n        onSelectedItem={(item) => {\r\n        }} />);\r\n    });\r\n  });\r\n  it(\"Should call onSelectedItem (multi)\", () => {\r\n    return new Promise((resolve, error) => {\r\n      let comboBox = mount(<ComboBoxListItemPicker\r\n        columnInternalName=\"Title\"\r\n        spHttpClient={mockHttpClient}\r\n        webUrl=\"/sites/test-site\"\r\n        filter=\"Id gt 0\"\r\n        listId=\"TestId\"\r\n        multiSelect={true}\r\n        onInitialized={() => {\r\n\r\n          let ddBtn = comboBox.find('.ms-Button-flexContainer').first();\r\n          ddBtn.simulate('click');\r\n          //actual list is not part of the component\r\n          let checkBoxBtn = document.querySelectorAll('.ms-ComboBox-option')[3];\r\n          (checkBoxBtn as HTMLButtonElement).click();\r\n          //ddBtn.simulate('click');\r\n        }}\r\n        onSelectedItem={(item) => {\r\n          expect(item.Id).to.equal(4);\r\n          expect(item.selected).to.be.equal(true);\r\n\r\n          let ddBtn = comboBox.find('.ms-Button-flexContainer').first();\r\n          ddBtn.simulate('click');\r\n          resolve();\r\n        }} />);\r\n    });\r\n  });\r\n  it(\"Should initialize with default selection (multi) (object)\", () => {\r\n    return new Promise((resolve, error) => {\r\n      let comboBox = mount(<ComboBoxListItemPicker\r\n        columnInternalName=\"Title\"\r\n        spHttpClient={mockHttpClient}\r\n        webUrl=\"/sites/test-site\"\r\n        defaultSelectedItems={[{Id:1, Title: \"Test 1\"},{ Id:2, Title: \"Test 2\"}]}\r\n        filter=\"Id gt 0\"\r\n        listId=\"TestId\"\r\n        multiSelect={true}\r\n        onInitialized={() => {\r\n\r\n          let ddBtn = comboBox.find('.ms-Button-flexContainer').first();\r\n          ddBtn.simulate('click');\r\n          let checkBoxBtn = document.querySelectorAll('.ms-ComboBox-option')[0];\r\n          expect(checkBoxBtn.classList.contains(\"is-checked\")).to.be.equal(true);\r\n          let ddInput = comboBox.find('.ms-ComboBox-Input').first();\r\n          expect((ddInput.getNode() as any).value).to.be.equal(\"Test 1, Test 2\");\r\n          ddBtn.simulate('click');\r\n          resolve();\r\n        }}\r\n        onSelectedItem={(item) => {\r\n        }} />);\r\n    });\r\n  });\r\n  it(\"Should initialize with default selection (multi) (id)\", () => {\r\n    return new Promise((resolve, error) => {\r\n      let comboBox = mount(<ComboBoxListItemPicker\r\n        columnInternalName=\"Title\"\r\n        spHttpClient={mockHttpClient}\r\n        webUrl=\"/sites/test-site\"\r\n        defaultSelectedItems={[1,2]}\r\n        filter=\"Id gt 0\"\r\n        listId=\"TestId\"\r\n        multiSelect={true}\r\n        onInitialized={() => {\r\n\r\n          let ddBtn = comboBox.find('.ms-Button-flexContainer').first();\r\n          ddBtn.simulate('click');\r\n          let checkBoxBtn = document.querySelectorAll('.ms-ComboBox-option')[0];\r\n          expect(checkBoxBtn.classList.contains(\"is-checked\")).to.be.equal(true);\r\n\r\n          let ddInput = comboBox.find('.ms-ComboBox-Input').first();\r\n          expect((ddInput.getNode() as any).value).to.be.equal(\"Test 1, Test 2\");\r\n          ddBtn.simulate('click');\r\n          resolve();\r\n        }}\r\n        onSelectedItem={(item) => {\r\n        }} />);\r\n    });\r\n  });\r\n});\r\n"],"sourceRoot":"..\\..\\..\\src"}